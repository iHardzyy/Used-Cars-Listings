<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pre Owned Motors - Dealership Delivery</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background: #1a1a1a;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            font-family: 'Roboto', sans-serif;
            color: #e0e0e0;
            overflow: hidden;
        }

        #gameContainer {
            background: #222;
            border: 4px solid #2a4a46;
            position: relative;
            box-shadow: 0 0 50px rgba(0,0,0,0.6);
            border-radius: 12px;
            overflow: hidden;
        }

        #gameCanvas {
            display: block;
            background: #2a2a2a;
        }

        #ui {
            position: absolute;
            top: 20px;
            left: 20px;
            color: #ffc107;
            font-size: 18px;
            font-weight: 700;
            z-index: 10;
            pointer-events: none;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
            display: flex;
            flex-direction: column;
            gap: 10px;
            background: rgba(0,0,0,0.6);
            padding: 15px 20px;
            border-radius: 10px;
            border: 1px solid rgba(255,193,7,0.3);
        }

        .ui-item span {
            color: #fff;
            font-family: monospace;
        }

        .controls {
            position: absolute;
            bottom: 20px;
            right: 20px;
            color: #fff;
            font-size: 13px;
            text-align: right;
            z-index: 10;
            pointer-events: none;
            background: rgba(0,0,0,0.6);
            padding: 12px;
            border-radius: 8px;
            border: 1px solid rgba(255,255,255,0.1);
        }
        
        .header {
            margin-bottom: 20px;
            text-align: center;
        }
        
        .header h1 {
            margin: 0;
            font-size: 2.8rem;
            font-weight: 900;
            background: linear-gradient(45deg, #fff, #ffc107, #2a4a46);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .back-link {
            margin-top: 25px;
            color: #ffc107;
            text-decoration: none;
            font-weight: 700;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .back-link:hover {
            color: #fff;
            transform: translateX(-5px);
            text-shadow: 0 0 15px rgba(255,193,7,0.6);
        }

        #messageOverlay {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0,0,0,0.85);
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            border: 2px solid #ffc107;
            z-index: 100;
            display: none;
        }

        #messageOverlay h2 {
            font-size: 32px;
            margin-top: 0;
            color: #ffc107;
        }

        #messageOverlay button {
            background: #2a4a46;
            color: white;
            border: none;
            padding: 12px 30px;
            font-size: 18px;
            font-weight: 700;
            border-radius: 8px;
            cursor: pointer;
            margin-top: 20px;
            transition: all 0.3s;
        }

        #messageOverlay button:hover {
            background: #3b635f;
            transform: scale(1.05);
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Dealership Delivery</h1>
    </div>
    <div id="gameContainer">
        <canvas id="gameCanvas" width="800" height="600"></canvas>
        <div id="ui">
            <div class="ui-item">REVENUE: $<span id="score">0</span></div>
            <div class="ui-item">DELIVERIES: <span id="deliveries">0</span>/5</div>
            <div class="ui-item">VEHICLE: <span id="carName">Staff Van</span></div>
        </div>
        <div class="controls">
            <div>W / UP: Accelerate</div>
            <div>S / DOWN: Brake / Reverse</div>
            <div>A / D / LEFT / RIGHT: Steer</div>
            <div>SPACE: Handbrake</div>
        </div>
        <div id="messageOverlay">
            <h2 id="overlayTitle">SHIFT COMPLETE</h2>
            <p id="overlayText">You delivered all vehicles successfully!</p>
            <button id="overlayBtn">Next Shift</button>
        </div>
    </div>
    <a href="index.html" class="back-link">‚Üê Return to Showroom</a>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const scoreEl = document.getElementById('score');
        const deliveriesEl = document.getElementById('deliveries');
        const carNameEl = document.getElementById('carName');
        const overlay = document.getElementById('messageOverlay');
        const overlayTitle = document.getElementById('overlayTitle');
        const overlayText = document.getElementById('overlayText');
        const overlayBtn = document.getElementById('overlayBtn');

        let score = 0;
        let deliveries = 0;
        const totalDeliveries = 5;
        let gameState = 'playing';

        const keys = {};
        window.addEventListener('keydown', e => keys[e.code] = true);
        window.addEventListener('keyup', e => keys[e.code] = false);

        class Car {
            constructor(x, y, color, isPlayer = false) {
                this.x = x;
                this.y = y;
                this.width = 40;
                this.height = 20;
                this.angle = 0;
                this.speed = 0;
                this.maxSpeed = isPlayer ? 5 : 3;
                this.acc = 0.2;
                this.friction = 0.05;
                this.color = color;
                this.isPlayer = isPlayer;
                this.turnSpeed = 0.05;
            }

            update() {
                if (this.isPlayer && gameState === 'playing') {
                    if (keys['KeyW'] || keys['ArrowUp']) this.speed += this.acc;
                    if (keys['KeyS'] || keys['ArrowDown']) this.speed -= this.acc;
                    
                    const actualTurnSpeed = this.turnSpeed * (Math.abs(this.speed) / 3 + 0.2);
                    if (keys['KeyA'] || keys['ArrowLeft']) this.angle -= actualTurnSpeed;
                    if (keys['KeyD'] || keys['ArrowRight']) this.angle += actualTurnSpeed;

                    if (keys['Space']) {
                        this.speed *= 0.9;
                    }
                }

                if (this.speed > this.maxSpeed) this.speed = this.maxSpeed;
                if (this.speed < -this.maxSpeed / 2) this.speed = -this.maxSpeed / 2;

                if (this.speed > 0) this.speed -= this.friction;
                if (this.speed < 0) this.speed += this.friction;
                if (Math.abs(this.speed) < this.friction) this.speed = 0;

                this.x += Math.cos(this.angle) * this.speed;
                this.y += Math.sin(this.angle) * this.speed;

                if (this.x < 20) this.x = 20;
                if (this.x > canvas.width - 20) this.x = canvas.width - 20;
                if (this.y < 20) this.y = 20;
                if (this.y > canvas.height - 20) this.y = canvas.height - 20;
            }

            draw() {
                ctx.save();
                ctx.translate(this.x, this.y);
                ctx.rotate(this.angle);
                
                ctx.fillStyle = this.color;
                ctx.fillRect(-this.width/2, -this.height/2, this.width, this.height);
                
                ctx.fillStyle = 'rgba(0,0,0,0.3)';
                ctx.fillRect(this.width/4, -this.height/2, this.width/4, this.height);
                
                ctx.fillStyle = '#add8e6';
                ctx.fillRect(this.width/6, -this.height/2.5, this.width/6, this.height*0.8);
                
                ctx.fillStyle = '#ffc107';
                ctx.fillRect(this.width/2 - 5, -this.height/2 + 2, 5, 4);
                ctx.fillRect(this.width/2 - 5, this.height/2 - 6, 5, 4);
                
                ctx.restore();
            }
        }

        class Obstacle {
            constructor(x, y, w, h) {
                this.x = x;
                this.y = y;
                this.w = w;
                this.h = h;
            }

            draw() {
                ctx.fillStyle = '#3b635f';
                ctx.fillRect(this.x, this.y, this.w, this.h);
                ctx.strokeStyle = '#2a4a46';
                ctx.lineWidth = 2;
                ctx.strokeRect(this.x + 5, this.y + 5, this.w - 10, this.h - 10);
            }

            checkCollision(car) {
                const cx = car.x;
                const cy = car.y;
                if (cx > this.x && cx < this.x + this.w && cy > this.y && cy < this.y + this.h) {
                    car.speed *= -0.5;
                    return true;
                }
                return false;
            }
        }

        class Goal {
            constructor() {
                this.reset();
            }

            reset() {
                this.x = 50 + Math.random() * (canvas.width - 100);
                this.y = 50 + Math.random() * (canvas.height - 100);
                this.size = 60;
                this.isActive = true;
                
                obstacles.forEach(obs => {
                    if (this.x > obs.x - 50 && this.x < obs.x + obs.w + 50 && 
                        this.y > obs.y - 50 && this.y < obs.y + obs.h + 50) {
                        this.reset();
                    }
                });
            }

            draw() {
                if (!this.isActive) return;
                ctx.save();
                ctx.setLineDash([5, 5]);
                ctx.strokeStyle = '#ffc107';
                ctx.lineWidth = 3;
                ctx.strokeRect(this.x - this.size/2, this.y - this.size/2, this.size, this.size);
                
                ctx.fillStyle = 'rgba(255,193,7,0.1)';
                ctx.fillRect(this.x - this.size/2, this.y - this.size/2, this.size, this.size);
                
                ctx.fillStyle = '#ffc107';
                ctx.font = 'bold 12px Roboto';
                ctx.textAlign = 'center';
                ctx.fillText("DELIVERY ZONE", this.x, this.y + 5);
                ctx.restore();
            }

            check(car) {
                if (!this.isActive) return false;
                const dist = Math.sqrt((car.x - this.x)**2 + (car.y - this.y)**2);
                if (dist < 30 && Math.abs(car.speed) < 0.5) {
                    return true;
                }
                return false;
            }
        }

        const player = new Car(100, 100, '#ffc107', true);
        const obstacles = [
            new Obstacle(200, 0, 40, 200),
            new Obstacle(200, 400, 40, 200),
            new Obstacle(500, 200, 200, 40),
            new Obstacle(0, 300, 100, 40),
            new Obstacle(700, 300, 100, 40)
        ];
        const goal = new Goal();

        function update() {
            if (gameState !== 'playing') return;

            player.update();
            obstacles.forEach(obs => obs.checkCollision(player));

            if (goal.check(player)) {
                deliveries++;
                score += 1500;
                scoreEl.textContent = score;
                deliveriesEl.textContent = deliveries;
                
                if (deliveries >= totalDeliveries) {
                    winShift();
                } else {
                    goal.reset();
                }
            }
        }

        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            ctx.strokeStyle = 'rgba(255,255,255,0.05)';
            ctx.lineWidth = 1;
            for(let i=0; i<canvas.width; i+=40) {
                ctx.beginPath(); ctx.moveTo(i,0); ctx.lineTo(i,canvas.height); ctx.stroke();
            }
            for(let i=0; i<canvas.height; i+=40) {
                ctx.beginPath(); ctx.moveTo(0,i); ctx.lineTo(canvas.width,i); ctx.stroke();
            }

            obstacles.forEach(obs => obs.draw());
            goal.draw();
            player.draw();
        }

        function winShift() {
            gameState = 'win';
            overlay.style.display = 'block';
            overlayTitle.textContent = "SHIFT COMPLETE!";
            overlayText.textContent = `You earned $${score} for Pre Owned Motors today. Excellent work!`;
            overlayBtn.textContent = "Start Next Shift";
        }

        overlayBtn.onclick = () => {
            deliveries = 0;
            score = 0;
            scoreEl.textContent = "0";
            deliveriesEl.textContent = "0";
            gameState = 'playing';
            overlay.style.display = 'none';
            player.x = 100;
            player.y = 100;
            player.angle = 0;
            player.speed = 0;
            goal.reset();
        };

        function gameLoop() {
            update();
            draw();
            requestAnimationFrame(gameLoop);
        }

        gameLoop();
    </script>
</body>
</html>
