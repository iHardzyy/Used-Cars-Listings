<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pre Owned Motors - Dealership Delivery</title>
    <style>
        body {
            margin: 0;
            padding: 20px 0;
            background: #1a1a1a;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: center;
            min-height: 100vh;
            font-family: 'Roboto', sans-serif;
            color: #e0e0e0;
            overflow-y: auto;
        }

        #gameContainer {
            background: #222;
            border: 4px solid #2a4a46;
            position: relative;
            box-shadow: 0 0 50px rgba(0,0,0,0.6);
            border-radius: 12px;
            overflow: hidden;
        }

        #gameCanvas {
            display: block;
            background: #2a2a2a;
        }

        #ui {
            position: absolute;
            top: 20px;
            left: 20px;
            color: #ffc107;
            font-size: 18px;
            font-weight: 700;
            z-index: 10;
            pointer-events: none;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
            display: flex;
            flex-direction: column;
            gap: 10px;
            background: rgba(0,0,0,0.6);
            padding: 15px 20px;
            border-radius: 10px;
            border: 1px solid rgba(255,193,7,0.3);
        }

        #levelInfo {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(42, 74, 70, 0.8);
            padding: 10px 15px;
            border-radius: 8px;
            border: 1px solid #ffc107;
            color: #fff;
            font-weight: 700;
            z-index: 10;
        }

        .ui-item span {
            color: #fff;
            font-family: monospace;
        }

        .controls {
            position: absolute;
            bottom: 20px;
            right: 20px;
            color: #fff;
            font-size: 13px;
            text-align: right;
            z-index: 10;
            pointer-events: none;
            background: rgba(0,0,0,0.6);
            padding: 12px;
            border-radius: 8px;
            border: 1px solid rgba(255,255,255,0.1);
        }
        
        .header {
            margin-bottom: 20px;
            text-align: center;
        }

        .intro-section {
            background: rgba(42, 74, 70, 0.15);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(42, 74, 70, 0.3);
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 30px;
            max-width: 800px;
            display: flex;
            align-items: center;
            gap: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .intro-image {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            border: 3px solid #ffc107;
            object-fit: cover;
            background: #2a4a46;
            flex-shrink: 0;
            box-shadow: 0 0 15px rgba(255, 193, 7, 0.3);
        }

        .intro-text {
            color: #e0e0e0;
            font-size: 1.1rem;
            line-height: 1.6;
            text-align: left;
        }

        .intro-text b {
            color: #ffc107;
        }
        
        .header h1 {
            margin: 0;
            font-size: 2.8rem;
            font-weight: 900;
            background: linear-gradient(45deg, #fff, #ffc107, #2a4a46);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .back-link {
            margin-top: 25px;
            color: #ffc107;
            text-decoration: none;
            font-weight: 700;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .back-link:hover {
            color: #fff;
            transform: translateX(-5px);
            text-shadow: 0 0 15px rgba(255,193,7,0.6);
        }

        #messageOverlay {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0,0,0,0.9);
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            border: 2px solid #ffc107;
            z-index: 100;
            width: 80%;
            max-width: 500px;
            box-shadow: 0 0 100px rgba(0,0,0,1);
        }

        #messageOverlay h2 {
            font-size: 32px;
            margin-top: 0;
            color: #ffc107;
        }

        #messageOverlay button {
            background: #2a4a46;
            color: white;
            border: none;
            padding: 12px 30px;
            font-size: 18px;
            font-weight: 700;
            border-radius: 8px;
            cursor: pointer;
            margin: 10px;
            transition: all 0.3s;
        }

        #messageOverlay button:hover {
            background: #3b635f;
            transform: scale(1.05);
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Dealership Delivery</h1>
    </div>

    <div class="intro-section">
        <img src="https://i.ibb.co/HLVKhZP5/AK.png" alt="Alex King" class="intro-image">
        <div class="intro-text">
            Hello, I'm <b>Alex King</b>. I made this website <b>July 8th 2025</b> and it was a test to see how much i could improve at HTML and JS Code.
        </div>
    </div>

    <div id="gameContainer">
        <canvas id="gameCanvas" width="800" height="600"></canvas>
        <div id="ui">
            <div class="ui-item">REVENUE: $<span id="score">0</span></div>
            <div class="ui-item">DELIVERIES: <span id="deliveries">0</span>/3</div>
            <div class="ui-item">VEHICLE: <span id="carNameDisplay">Staff Van</span></div>
        </div>
        <div id="levelInfo">LEVEL: <span id="levelName">Main Showroom</span></div>
        <div class="controls">
            <div>W / UP: Accelerate</div>
            <div>S / DOWN: Brake / Reverse</div>
            <div>A / D / LEFT / RIGHT: Steer</div>
            <div>SPACE: Handbrake</div>
        </div>
        <div id="messageOverlay">
            <h2 id="overlayTitle">SHIFT COMPLETE</h2>
            <p id="overlayText">You delivered all vehicles successfully!</p>
            <div id="overlayButtons">
                <button id="overlayBtn">Next Shift</button>
            </div>
        </div>
    </div>
    <a href="index.html" class="back-link">‚Üê Return to Showroom</a>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const scoreEl = document.getElementById('score');
        const deliveriesEl = document.getElementById('deliveries');
        const carNameDisplay = document.getElementById('carNameDisplay');
        const levelNameEl = document.getElementById('levelName');
        const overlay = document.getElementById('messageOverlay');
        const overlayTitle = document.getElementById('overlayTitle');
        const overlayText = document.getElementById('overlayText');
        const overlayBtn = document.getElementById('overlayBtn');
        const overlayButtons = document.getElementById('overlayButtons');

        let score = 0;
        let deliveries = 0;
        let currentLevel = 0;
        let gameState = 'start'; // 'start', 'playing', 'win', 'levelup'
        let careerRevenue = parseInt(localStorage.getItem('careerRevenue')) || 0;

        const levels = [
            {
                name: "Main Showroom",
                totalDeliveries: 3,
                reward: 500,
                obstacles: [
                    {x: 200, y: 0, w: 40, h: 200},
                    {x: 200, y: 400, w: 40, h: 200},
                    {x: 500, y: 200, w: 200, h: 40}
                ]
            },
            {
                name: "Inventory Lot",
                totalDeliveries: 4,
                reward: 800,
                obstacles: [
                    {x: 0, y: 300, w: 150, h: 40},
                    {x: 650, y: 300, w: 150, h: 40},
                    {x: 350, y: 150, w: 100, h: 300},
                    {x: 100, y: 100, w: 50, h: 50},
                    {x: 650, y: 100, w: 50, h: 50}
                ]
            },
            {
                name: "The Sales Floor",
                totalDeliveries: 5,
                reward: 1200,
                obstacles: [
                    {x: 150, y: 150, w: 500, h: 30},
                    {x: 150, y: 420, w: 500, h: 30},
                    {x: 385, y: 0, w: 30, h: 180},
                    {x: 385, y: 420, w: 30, h: 180}
                ]
            },
            {
                name: "Service Bay",
                totalDeliveries: 6,
                reward: 1500,
                obstacles: [
                    {x: 100, y: 100, w: 200, h: 200},
                    {x: 500, y: 100, w: 200, h: 200},
                    {x: 100, y: 400, w: 600, h: 40}
                ]
            },
            {
                name: "The Expansion Lot",
                totalDeliveries: 7,
                reward: 2000,
                obstacles: [
                    {x: 0, y: 0, w: 800, h: 20},
                    {x: 0, y: 580, w: 800, h: 20},
                    {x: 0, y: 0, w: 20, h: 600},
                    {x: 780, y: 0, w: 20, h: 600},
                    {x: 200, y: 200, w: 400, h: 200}
                ]
            },
            {
                name: "Rooftop Storage",
                totalDeliveries: 8,
                reward: 2500,
                obstacles: [
                    {x: 100, y: 100, w: 50, h: 400},
                    {x: 250, y: 100, w: 50, h: 400},
                    {x: 400, y: 100, w: 50, h: 400},
                    {x: 550, y: 100, w: 50, h: 400},
                    {x: 700, y: 100, w: 50, h: 400}
                ]
            },
            {
                name: "VIP Showroom",
                totalDeliveries: 10,
                reward: 5000,
                obstacles: [
                    {x: 0, y: 0, w: 200, h: 200},
                    {x: 600, y: 0, w: 200, h: 200},
                    {x: 0, y: 400, w: 200, h: 200},
                    {x: 600, y: 400, w: 200, h: 200},
                    {x: 350, y: 250, w: 100, h: 100}
                ]
            }
        ];

        const vehicles = [
            { name: "Staff Van", color: "#ffc107", maxSpeed: 4.5, acc: 0.15, turnSpeed: 0.04 },
            { name: "Sports Coupe", color: "#e8455a", maxSpeed: 6.5, acc: 0.3, turnSpeed: 0.06 },
            { name: "Heavy Truck", color: "#2a4a46", maxSpeed: 3.5, acc: 0.1, turnSpeed: 0.03 }
        ];

        let currentVehicleIndex = 0;

        const keys = {};
        window.addEventListener('keydown', e => keys[e.code] = true);
        window.addEventListener('keyup', e => keys[e.code] = false);

        class Car {
            constructor(x, y, vehicleData, isPlayer = false) {
                this.x = x;
                this.y = y;
                this.width = 40;
                this.height = 20;
                this.angle = 0;
                this.speed = 0;
                this.maxSpeed = vehicleData.maxSpeed;
                this.acc = vehicleData.acc;
                this.friction = 0.05;
                this.color = vehicleData.color;
                this.name = vehicleData.name;
                this.isPlayer = isPlayer;
                this.turnSpeed = vehicleData.turnSpeed;
            }

            update() {
                if (this.isPlayer && gameState === 'playing') {
                    if (keys['KeyW'] || keys['ArrowUp']) this.speed += this.acc;
                    if (keys['KeyS'] || keys['ArrowDown']) this.speed -= this.acc;
                    
                    const actualTurnSpeed = this.turnSpeed * (Math.abs(this.speed) / 2 + 0.3);
                    if (keys['KeyA'] || keys['ArrowLeft']) this.angle -= actualTurnSpeed;
                    if (keys['KeyD'] || keys['ArrowRight']) this.angle += actualTurnSpeed;

                    if (keys['Space']) {
                        this.speed *= 0.85;
                    }
                }

                if (this.speed > this.maxSpeed) this.speed = this.maxSpeed;
                if (this.speed < -this.maxSpeed / 2) this.speed = -this.maxSpeed / 2;

                if (this.speed > 0) this.speed -= this.friction;
                if (this.speed < 0) this.speed += this.friction;
                if (Math.abs(this.speed) < this.friction) this.speed = 0;

                this.x += Math.cos(this.angle) * this.speed;
                this.y += Math.sin(this.angle) * this.speed;

                if (this.x < 20) { this.x = 20; this.speed *= -0.5; }
                if (this.x > canvas.width - 20) { this.x = canvas.width - 20; this.speed *= -0.5; }
                if (this.y < 20) { this.y = 20; this.speed *= -0.5; }
                if (this.y > canvas.height - 20) { this.y = canvas.height - 20; this.speed *= -0.5; }
            }

            draw() {
                ctx.save();
                ctx.translate(this.x, this.y);
                ctx.rotate(this.angle);
                
                ctx.fillStyle = this.color;
                ctx.fillRect(-this.width/2, -this.height/2, this.width, this.height);
                
                ctx.fillStyle = 'rgba(0,0,0,0.3)';
                ctx.fillRect(this.width/4, -this.height/2, this.width/4, this.height);
                
                ctx.fillStyle = '#add8e6';
                ctx.fillRect(this.width/6, -this.height/2.5, this.width/6, this.height*0.8);
                
                ctx.fillStyle = this.isPlayer ? '#fff' : '#ffc107';
                ctx.fillRect(this.width/2 - 5, -this.height/2 + 2, 5, 4);
                ctx.fillRect(this.width/2 - 5, this.height/2 - 6, 5, 4);
                
                ctx.restore();
            }
        }

        class Obstacle {
            constructor(x, y, w, h) {
                this.x = x;
                this.y = y;
                this.w = w;
                this.h = h;
            }

            draw() {
                ctx.fillStyle = '#3b635f';
                ctx.fillRect(this.x, this.y, this.w, this.h);
                ctx.strokeStyle = '#2a4a46';
                ctx.lineWidth = 2;
                ctx.strokeRect(this.x + 5, this.y + 5, this.w - 10, this.h - 10);
            }

            checkCollision(car) {
                const cx = car.x;
                const cy = car.y;
                if (cx > this.x && cx < this.x + this.w && cy > this.y && cy < this.y + this.h) {
                    car.speed *= -0.5;
                    return true;
                }
                return false;
            }
        }

        class Goal {
            constructor() {
                this.reset();
            }

            reset() {
                this.x = 50 + Math.random() * (canvas.width - 100);
                this.y = 50 + Math.random() * (canvas.height - 100);
                this.size = 60;
                this.isActive = true;
                
                obstacles.forEach(obs => {
                    if (this.x > obs.x - 50 && this.x < obs.x + obs.w + 50 && 
                        this.y > obs.y - 50 && this.y < obs.y + obs.h + 50) {
                        this.reset();
                    }
                });
            }

            draw() {
                if (!this.isActive) return;
                ctx.save();
                ctx.setLineDash([5, 5]);
                ctx.strokeStyle = '#ffc107';
                ctx.lineWidth = 3;
                ctx.strokeRect(this.x - this.size/2, this.y - this.size/2, this.size, this.size);
                
                ctx.fillStyle = 'rgba(255,193,7,0.1)';
                ctx.fillRect(this.x - this.size/2, this.y - this.size/2, this.size, this.size);
                
                ctx.fillStyle = '#ffc107';
                ctx.font = 'bold 12px Roboto';
                ctx.textAlign = 'center';
                ctx.fillText("DELIVERY ZONE", this.x, this.y + 5);
                ctx.restore();
            }

            check(car) {
                if (!this.isActive) return false;
                const dist = Math.sqrt((car.x - this.x)**2 + (car.y - this.y)**2);
                if (dist < 30 && Math.abs(car.speed) < 0.5) {
                    return true;
                }
                return false;
            }
        }

        class Traffic {
            constructor() {
                this.reset();
            }

            reset() {
                this.vertical = Math.random() > 0.5;
                if (this.vertical) {
                    this.x = 50 + Math.random() * (canvas.width - 100);
                    this.y = Math.random() > 0.5 ? -50 : canvas.height + 50;
                    this.speed = (2 + Math.random() * 2) * (this.y < 0 ? 1 : -1);
                    this.angle = this.y < 0 ? Math.PI/2 : -Math.PI/2;
                } else {
                    this.y = 50 + Math.random() * (canvas.height - 100);
                    this.x = Math.random() > 0.5 ? -50 : canvas.width + 50;
                    this.speed = (2 + Math.random() * 2) * (this.x < 0 ? 1 : -1);
                    this.angle = this.x < 0 ? 0 : Math.PI;
                }
                this.width = 40;
                this.height = 20;
                this.color = '#555';
            }

            update() {
                if (this.vertical) this.y += this.speed;
                else this.x += this.speed;

                if (this.x < -100 || this.x > canvas.width + 100 || this.y < -100 || this.y > canvas.height + 100) {
                    this.reset();
                }
            }

            draw() {
                ctx.save();
                ctx.translate(this.x, this.y);
                ctx.rotate(this.angle);
                ctx.fillStyle = this.color;
                ctx.fillRect(-this.width/2, -this.height/2, this.width, this.height);
                ctx.fillStyle = '#fff';
                ctx.fillRect(this.width/2 - 5, -this.height/2 + 2, 5, 4);
                ctx.fillRect(this.width/2 - 5, this.height/2 - 6, 5, 4);
                ctx.restore();
            }

            checkCollision(car) {
                const dist = Math.sqrt((car.x - this.x)**2 + (car.y - this.y)**2);
                if (dist < 25) {
                    car.speed *= -0.8;
                    return true;
                }
                return false;
            }
        }

        let player = new Car(100, 100, vehicles[0], true);
        let obstacles = [];
        let traffic = [];
        const goal = new Goal();

        function initLevel(levelIdx) {
            const level = levels[levelIdx];
            levelNameEl.textContent = level.name;
            deliveriesEl.textContent = `0/${level.totalDeliveries}`;
            obstacles = level.obstacles.map(o => new Obstacle(o.x, o.y, o.w, o.h));
            
            traffic = [];
            const trafficCount = Math.floor(levelIdx / 2);
            for(let i=0; i<trafficCount; i++) {
                traffic.push(new Traffic());
            }

            currentVehicleIndex = Math.floor(Math.random() * vehicles.length);
            const vehicle = vehicles[currentVehicleIndex];
            carNameDisplay.textContent = vehicle.name;
            
            player = new Car(100, 100, vehicle, true);
            deliveries = 0;
            goal.reset();
            gameState = 'playing';
            overlay.style.display = 'none';
        }

        function showStartScreen() {
            gameState = 'start';
            overlay.style.display = 'block';
            overlayTitle.textContent = "DEALERSHIP DELIVERY";
            overlayText.innerHTML = `
                Welcome to your shift at Pre Owned Motors!<br><br>
                Career Revenue: <b>$${careerRevenue}</b><br><br>
                Deliver vehicles to the marked zones to earn revenue.<br>
                Complete shifts to unlock more dealership lots.
            `;
            overlayButtons.innerHTML = '<button id="startBtn">Start Shift</button>';
            document.getElementById('startBtn').onclick = () => initLevel(0);
        }

        function update() {
            if (gameState !== 'playing') return;

            player.update();
            obstacles.forEach(obs => obs.checkCollision(player));
            traffic.forEach(t => {
                t.update();
                t.checkCollision(player);
            });

            if (goal.check(player)) {
                deliveries++;
                const level = levels[currentLevel];
                score += 250; 
                scoreEl.textContent = score;
                deliveriesEl.textContent = `${deliveries}/${level.totalDeliveries}`;
                
                if (deliveries >= level.totalDeliveries) {
                    winShift();
                } else {
                    goal.reset();
                }
            }
        }

        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            ctx.strokeStyle = 'rgba(255,255,255,0.05)';
            ctx.lineWidth = 1;
            for(let i=0; i<canvas.width; i+=40) {
                ctx.beginPath(); ctx.moveTo(i,0); ctx.lineTo(i,canvas.height); ctx.stroke();
            }
            for(let i=0; i<canvas.height; i+=40) {
                ctx.beginPath(); ctx.moveTo(0,i); ctx.lineTo(canvas.width,i); ctx.stroke();
            }

            obstacles.forEach(obs => obs.draw());
            traffic.forEach(t => t.draw());
            goal.draw();
            player.draw();
        }

        function winShift() {
            gameState = 'win';
            const level = levels[currentLevel];
            const bonus = level.reward;
            score += bonus;
            careerRevenue += score;
            localStorage.setItem('careerRevenue', careerRevenue);
            
            overlay.style.display = 'block';
            overlayTitle.textContent = "SHIFT COMPLETE!";
            overlayText.innerHTML = `
                You completed the shift at <b>${level.name}</b>!<br>
                Shift Revenue: $${score}<br>
                Shift Bonus: $${bonus}<br><br>
                Total Career Revenue: $${careerRevenue}
            `;
            
            overlayButtons.innerHTML = '';
            if (currentLevel < levels.length - 1) {
                const nextBtn = document.createElement('button');
                nextBtn.textContent = "Next Lot";
                nextBtn.onclick = () => {
                    currentLevel++;
                    score = 0;
                    scoreEl.textContent = "0";
                    initLevel(currentLevel);
                };
                overlayButtons.appendChild(nextBtn);
            } else {
                overlayTitle.textContent = "CAREER PROMOTION!";
                overlayText.innerHTML += "<br><br>You've completed all available shifts! You're a legend at Pre Owned Motors.";
                const restartBtn = document.createElement('button');
                restartBtn.textContent = "Restart Career";
                restartBtn.onclick = () => {
                    currentLevel = 0;
                    score = 0;
                    scoreEl.textContent = "0";
                    initLevel(0);
                };
                overlayButtons.appendChild(restartBtn);
            }
        }

        function gameLoop() {
            update();
            draw();
            requestAnimationFrame(gameLoop);
        }

        showStartScreen();
        gameLoop();
    </script>
</body>
</html>
